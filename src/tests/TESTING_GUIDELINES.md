# Testing Guidelines for nself

## Important: Always Use Temporary Directories

When testing nself commands that generate files (init, build, start), **ALWAYS** use a temporary directory to avoid polluting the source tree.

### Quick Test Method

Use the provided test script:
```bash
bash src/tests/test-in-temp.sh
```

### Manual Testing in Temp Directory

```bash
# Create temp directory
TEMP_DIR="/tmp/nself-test-$$"
mkdir -p "$TEMP_DIR"
cd "$TEMP_DIR"

# Copy test config
cp /path/to/nself/src/templates/demo/.env.demo .env

# Run nself commands
bash /path/to/nself/src/cli/build.sh
bash /path/to/nself/src/cli/urls.sh
bash /path/to/nself/src/cli/start.sh

# Clean up when done
cd /
rm -rf "$TEMP_DIR"
```

## Files Generated by nself

The following files and directories are generated by nself commands and should NOT be committed to the repository:

### Directories
- `nginx/` - Nginx configuration
- `postgres/` - Database initialization scripts
- `ssl/` - SSL certificates
- `auth/` - Auth service configuration
- `hasura/` - Hasura metadata
- `storage/` - Storage service configuration
- `monitoring/` - Monitoring stack configs
- `functions/` - Functions configuration
- `services/` - Custom service code
- `logs/` - Service logs
- `.volumes/` - Docker volumes

### Files
- `docker-compose.yml` - Generated Docker Compose file
- `.env` - Environment configuration (unless it's a template)

## Git Ignore

These patterns are already in `.gitignore`:
```
# Generated by nself build
docker-compose.yml
nginx/
postgres/
ssl/
auth/
hasura/
storage/
monitoring/
functions/
services/
logs/
.volumes/
.env
.env.local
.env.dev
.env.staging
.env.production
```

## Testing Best Practices

1. **Never run `nself build` in the source directory** - Always use a temp directory
2. **Use the test script** - `src/tests/test-in-temp.sh` handles cleanup automatically
3. **Check for artifacts** - After testing, verify no generated files remain in the source tree
4. **Clean up temp directories** - Remove `/tmp/nself-test-*` directories after testing
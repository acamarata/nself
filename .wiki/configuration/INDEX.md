# Configuration Documentation

Complete guide to configuring ɳSelf for all environments.

## Overview

- **[Configuration Guide](README.md)** - Complete configuration overview
- **[Environment Variables](ENVIRONMENT-VARIABLES.md)** - All .env variables with descriptions
- **[Complete Environment Reference](ENV-COMPLETE-REFERENCE.md)** - Comprehensive env variable listing

## Service Configuration

- **[Custom Services](CUSTOM-SERVICES-ENV-VARS.md)** - CS_N configuration for custom services
- **[Start Command Options](START-COMMAND-OPTIONS.md)** - Startup and health check configuration

## UI & Interface

- **[Admin UI](Admin-UI.md)** - Web dashboard configuration
- **[SSL Configuration](SSL.md)** - SSL and HTTPS setup

## Configuration Files

### Environment Files
- `.env` - Main configuration file
- `.env.local` - Local overrides (gitignored)
- `.env.dev` - Development defaults (committed)
- `.env.staging` - Staging environment (on server)
- `.env.prod` - Production environment (on server)
- `.secrets` - Production secrets (SSH-synced only)

### Generated Files
- `docker-compose.yml` - Generated by `nself build`
- `nginx/nginx.conf` - Generated nginx configuration
- `nginx/sites/*.conf` - Generated route configurations
- `postgres/init/*.sql` - Generated database initialization

## Configuration by Service Type

### Required Services (4)
Always enabled, configure via `.env`:
- **PostgreSQL** - `POSTGRES_*` variables
- **Hasura** - `HASURA_*` variables
- **Auth** - `AUTH_*` variables
- **Nginx** - `NGINX_*` variables

### Optional Services (7)
Enable with `*_ENABLED=true`:
- **Redis** - `REDIS_ENABLED=true`, `REDIS_*` variables
- **MinIO** - `MINIO_ENABLED=true`, `MINIO_*` variables
- **nself-admin** - `NSELF_ADMIN_ENABLED=true`
- **Search** - `MEILISEARCH_ENABLED=true` or `TYPESENSE_ENABLED=true`
- **Mail** - `MAILPIT_ENABLED=true` (dev) or SMTP config
- **Functions** - `FUNCTIONS_ENABLED=true`
- **MLflow** - `MLFLOW_ENABLED=true`

### Monitoring Bundle (10)
Enable all with `MONITORING_ENABLED=true`:
- Prometheus, Grafana, Loki, Promtail, Tempo
- Alertmanager, cAdvisor, Node Exporter
- Postgres Exporter, Redis Exporter

### Custom Services (CS_N)
Format: `CS_N=service_name:template_type:port`

Examples:
```bash
CS_1=api:express-js:8001
CS_2=worker:bullmq-js:8002
CS_3=grpc:grpc:8003
CS_4=ml-api:fastapi-py:8004
```

### Frontend Applications
External apps for nginx routing:
```bash
FRONTEND_APP_1_NAME=app1
FRONTEND_APP_1_PORT=3000
FRONTEND_APP_1_ROUTE=app1
```

## Configuration Best Practices

### Environment Hierarchy
Later files override earlier ones:
```
.env.dev → .env.local → .env.staging/.env.prod → .secrets
```

### Security
- Never commit `.env.local`, `.env.staging`, `.env.prod`, or `.secrets`
- Use `.secrets` for production credentials only
- Sync secrets via SSH only: `nself sync pull secrets`

### Development
- Use `.env.dev` for shared developer defaults
- Use `.env.local` for personal overrides
- Keep sensitive data out of git

### Production
- Generate `.secrets` on production server
- Use strong passwords (auto-generated recommended)
- Enable SSL/TLS for all services
- Configure proper backup retention

---

**[← Back to Documentation Home](../README.md)**
